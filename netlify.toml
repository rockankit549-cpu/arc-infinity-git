[build]
  command = "npm run build"
  publish = "."

[functions]
  directory = "netlify/functions"
  node_bundler = "esbuild"

[dev]
  command = "npm run dev"
  targetPort = 8888
  framework = "#static"

[context.production.environment]
  NODE_VERSION = "18"

[[redirects]]
  from = "/api/protected"
  to = "/.netlify/functions/protected"
  status = 200
  force = true

[[redirects]]
  from = "/api/clients"
  to = "/.netlify/functions/clients"
  status = 200
  force = true

[[redirects]]
  from = "/api/sites"
  to = "/.netlify/functions/sites"
  status = 200
  force = true

[[redirects]]
  from = "/api/tests"
  to = "/.netlify/functions/tests"
  status = 200
  force = true

[[redirects]]
  from = "/api/jobs"
  to = "/.netlify/functions/jobs"
  status = 200
  force = true

[[redirects]]
  from = "/api/client-documents"
  to = "/.netlify/functions/client-documents"
  status = 200
  force = true

[[redirects]]
  from = "/login"
  to = "/login.html"
  status = 200
  force = true

[[redirects]]
  from = "/login/"
  to = "/login.html"
  status = 200
  force = true

[[redirects]]
  from = "/client-dashboard.html"
  to = "/client-dashboard.html"
  status = 200
  force = true
  conditions = { Role = ["customer"] }

[[redirects]]
  from = "/employee-portal"
  to = "/employee-portal.html"
  status = 200
  force = true

[[redirects]]
  from = "/employee-portal/"
  to = "/employee-portal.html"
  status = 200
  force = true
